import{a as L}from"./apiService-77935b08.js";import{U as C}from"./util-75dcb7cf.js";import{A as B}from"./auth-eef4144a.js";import{w as D,D as w,G as S,H as x}from"./urls-04ad3523.js";import{e as v}from"./eduAction-d64f11a0.js";import{_ as M,m as U,f as A,r as E,o as r,j as T,c as h,a as t,F as k,b as I,e as m,w as u,h as F,k as P,v as g,t as b,n as N,p as O,g as R}from"./index-e96a63ea.js";import{_ as V}from"./ico_del-5d7ca91d.js";import{_ as j}from"./img_bot-69f44715.js";import"./axios-c24e582b.js";const G={computed:{...U(v,["basketProblemList","basketProblemInfoList","basketMode"])},watch:{$route(e,s){e.name=="eduCreateContentMobileByList"||e.name=="eduModifyContentMobileByList"?this.listDialog=!0:(e.name=="eduCreateByList"||e.name=="eduModifyByList")&&(this.listDialog=!1)},basketMode(e){if(e=="modal"){if(!this.selEduId){const s={message:"기존교육을 선택하세요"};this.emitter.emit("modalOpen",s);return}this.tempEduList=[],this.tempEduProblemList=[];for(const s of this.basketProblemInfoList)this.tempEduList.push(s.id),this.tempEduProblemList.push(s)}},allCheck(e){if(this.ids=[],e)for(const s of this.tempEduProblemList)this.ids.push(s.id)}},data(){return{ids:[],id:"",eduList:[],selEduId:"",botMessage:"등록해둔 교육 중 원하시는 수업을 선택해 주세요",tempEduList:[],tempEduProblemList:[],selectIndex:0,allCheck:!1,memberInfo:{},listDialog:!1}},created(){sessionStorage.getItem("tempEduForm")||this.$router.push("/edu/createList"),this.$route.name=="eduCreateContentMobileByList"||this.$route.name=="eduModifyContentMobileByList"?this.listDialog=!0:this.listDialog=!1,this.$route.params.eid&&(this.id=this.$route.params.eid);const e=B.getSession();(!e||!e.memberInfo||!e.memberInfo.payEndDate)&&(location.href="/"),this.memberInfo=e.memberInfo,this.tempForm=JSON.parse(sessionStorage.getItem("tempEduForm")),this.ptmBasketProblemInfoList(this.tempEduProblemList),this.ptmBasketProblemList(this.tempEduList),this.getData()},methods:{...A(v,["ptmBasketProblemList","ptmBasketProblemInfoList","ptlDialog","setSelEudId"]),getData(){const e={orderByField:"createAt",orderBySort:"desc",page:"1",id:this.id,limit:"1000"};L.post(D,e,s=>{if(s.list){let o="";for(let i of s.list)this.id!=i.id?(i.claDate=C.getTimeFormat(i.claDate),i.active="",this.eduList.push(i)):o=i.selEduId;if(o&&this.id){for(let i of this.eduList)i.id==o&&(i.active="active");if(this.selEduId=o,this.setSelEudId(this.selEduId),this.tempEduProblemList=[],this.tempEduList=[],s.isProblemList){for(let i of s.isProblemList)if(i.exists){let l=i.source;l.id=i.id,this.tempEduProblemList.push(l),this.tempEduList.push(i.id)}}this.ptmBasketProblemInfoList(this.tempEduProblemList),this.ptmBasketProblemList(this.tempEduList)}}})},selectEdu(e){this.selEduId=this.selEduId==e.id?"":e.id;for(let s of this.eduList)s.id==e.id?s.active=s.active?"":"active":s.active="";if(this.setSelEudId(this.selEduId),this.selEduId){const s={eids:e.eids};this.emitter.emit("overlay","open"),L.post(w,s,o=>{if(this.emitter.emit("overlay","hide"),this.tempEduProblemList=[],this.tempEduList=[],o.list){for(let i of o.list)if(i.exists){let l=i.source;l.id=i.id,this.tempEduProblemList.push(l),this.tempEduList.push(i.id)}}this.ptmBasketProblemInfoList(this.tempEduProblemList),this.ptmBasketProblemList(this.tempEduList)})}else this.tempEduProblemList=[],this.tempEduList=[],this.ptmBasketProblemInfoList(this.tempEduProblemList),this.ptmBasketProblemList(this.tempEduList)},tempDataCancle(){this.tempEduProblemList=[],this.tempEduList=[],this.ptmBasketProblemInfoList(this.tempEduProblemList),this.ptmBasketProblemList(this.tempEduList),this.selEduId="",this.setSelEudId(this.selEduId);for(let e of this.eduList)e.active=""},eduNewMake(){if(!this.selEduId){const i={message:"기존교육을 선택하세요"};this.emitter.emit("modalOpen",i);return}let e=S,s="선택 하신 과목으로 교육이 등록 되었습니다.<br>교육 시작 전 까지 교육 내용 수정이 가능합니다.";this.tempForm.eduId=this.selEduId,this.id&&(this.tempForm.id=this.id,s="선택 하신 과목으로 교육이 수정 되었습니다",e=x);const o=[];for(const i of this.tempEduProblemList)o.push(i.id);this.tempForm.eids=JSON.stringify(o),this.emitter.emit("overlay","open"),L.post(e,this.tempForm,i=>{this.emitter.emit("overlay","hide");const l={message:s,doAction:()=>{location.href="/edu/createList"}};this.emitter.emit("modalOpen",l)})},deleteBasket(e){const s={type:"confirm",message:"삭제하시겠습니까?",doAction:()=>{const o=this.tempEduProblemList[e];let i=0,l=0;for(const n of this.tempEduList){if(n==o.id){l=i;break}i++}if(this.tempEduList.splice(l,1),this.tempEduProblemList.splice(e,1),this.allCheck?this.allCheck=!1:this.ids=[],this.tempEduList.length<1){for(let n of this.eduList)n.active="";this.selEduId="",this.setSelEudId(this.selEduId)}}};this.emitter.emit("modalOpen",s)},down(e){if(e+1>=this.tempEduProblemList.length)return;const s=this.tempEduProblemList[e],o=this.tempEduProblemList[e+1];this.tempEduProblemList[e+1]=s,this.tempEduProblemList[e]=o},up(e){if(e<1)return;const s=this.tempEduProblemList[e],o=this.tempEduProblemList[e-1];this.tempEduProblemList[e-1]=s,this.tempEduProblemList[e]=o},allDelete(){if(this.ids.length<1){const s={message:"대상을 하나이상 선택하세요"};this.emitter.emit("modalOpen",s);return}const e={type:"confirm",message:"삭제하시겠습니까?",doAction:()=>{this.tempEduList=[];const s=[];for(const o of this.tempEduProblemList)this.ids.filter(l=>l===o.id).length<1&&(s.push(o),this.tempEduList.push(o.id));if(this.allCheck?this.allCheck=!1:this.ids=[],this.tempEduProblemList=s,this.tempEduList.length<1){for(let o of this.eduList)o.active="";this.selEduId="",this.setSelEudId(this.selEduId)}}};this.emitter.emit("modalOpen",e)},showProblems(){this.memberInfo.school.includes("초등학교");const e=this.memberInfo.school.includes("중학교"),s=this.memberInfo.school.includes("고등학교");let o="ele";e?o="mid":s&&(o="high");const i={gclass:this.memberInfo.gclass,grade:this.memberInfo.grade,schoolType:o};this.ptlDialog(i)}}},a=e=>(O("data-v-05340fa6"),e=e(),R(),e),Y={key:1,class:"edu-layout"},H={class:"left-container"},J=a(()=>t("div",{class:"sub-title"},"기존 교육에서 고르기",-1)),z={class:"table-box"},q={class:"edu-table",cellspacing:"0",cellpadding:"0",border:"0"},K=a(()=>t("thead",null,[t("tr",null,[t("th",{style:{width:"120px"}},"날짜"),t("th",{style:{width:"calc(100% - 240px)"}},"교육명"),t("th",{style:{width:"120px"}},"선택")])],-1)),Q={class:"subject-box"},W={class:"subject"},X=a(()=>t("span",null,"선택",-1)),Z={class:"button-row"},$=a(()=>t("span",null,"뒤로",-1)),tt=a(()=>t("div",{class:"blank-container"},null,-1)),et={class:"right-container"},st={key:0},it=a(()=>t("div",{class:"sub-header"},"담은 교육 목록",-1)),ot={class:"sub-body"},lt={class:"del-button"},dt=a(()=>t("img",{src:V},null,-1)),at={class:"table-box-out"},nt={class:"table-box"},mt={class:"edu-table",cellspacing:"0",cellpadding:"0",border:"0"},rt={style:{width:"80px"}},ht=a(()=>t("th",{class:"sm-tblet",style:{width:"50px"}},"순번",-1)),ct=a(()=>t("th",null,"교육명",-1)),ut=a(()=>t("th",{class:"mobile-tblet",style:{width:"75px"}},"순번 변경",-1)),pt=a(()=>t("th",{style:{width:"60px"}},"삭제",-1)),ft=["value"],bt={class:"sm-tblet"},_t={class:"subject-box"},Lt={class:"subject"},Et={class:"mobile-tblet"},vt={class:"updown-box"},kt=["onClick"],It={class:"button-row"},Pt=a(()=>t("span",null,"취소",-1)),gt=a(()=>t("span",null,"완료",-1)),yt={key:1,class:"bot-box"},Ct=a(()=>t("img",{src:j},null,-1)),Bt={class:"bot-message"};function Dt(e,s,o,i,l,n){const y=E("RouterView"),c=E("v-btn"),_=E("font-awesome-icon");return l.listDialog?(r(),T(y,{key:0})):(r(),h("div",Y,[t("div",H,[J,t("div",z,[t("table",q,[K,t("tbody",null,[(r(!0),h(k,null,I(l.eduList,(d,p)=>(r(),h("tr",null,[t("td",null,b(d.claDate),1),t("td",Q,[t("div",W,b(d.claName),1)]),t("td",null,[m(c,{type:"button",class:N("startButton "+d.active),variant:"outlined",color:"#DCDCDC",onClick:f=>n.selectEdu(d)},{default:u(()=>[X]),_:2},1032,["class","onClick"])])]))),256))])])]),t("div",Z,[m(c,{type:"button",variant:"tonal",class:"back-button",onClick:s[0]||(s[0]=d=>e.$router.back())},{default:u(()=>[$]),_:1})])]),tt,t("div",et,[l.tempEduProblemList.length>0?(r(),h("div",st,[it,t("div",ot,[t("div",lt,[t("span",{onClick:s[1]||(s[1]=(...d)=>n.allDelete&&n.allDelete(...d))},[dt,F(" 선택 삭제")])]),t("div",at,[t("div",nt,[t("table",mt,[t("thead",null,[t("tr",null,[t("th",rt,[P(t("input",{type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=d=>l.allCheck=d),value:"yes"},null,512),[[g,l.allCheck]])]),ht,ct,ut,pt])]),t("tbody",null,[(r(!0),h(k,null,I(l.tempEduProblemList,(d,p)=>(r(),h("tr",null,[t("td",null,[P(t("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=f=>l.ids=f),value:d.id},null,8,ft),[[g,l.ids]])]),t("td",bt,b(p+1),1),t("td",_t,[t("div",Lt,b(d.subject),1)]),t("td",Et,[t("div",vt,[m(c,{class:"updown",variant:"outlined",color:"#707070",onClick:f=>n.up(p)},{default:u(()=>[m(_,{class:"icon",icon:"fa-solid fa-caret-up"})]),_:2},1032,["onClick"]),m(c,{class:"updown",variant:"outlined",color:"#707070",onClick:f=>n.down(p)},{default:u(()=>[m(_,{class:"icon",icon:"fa-solid fa-caret-down"})]),_:2},1032,["onClick"])])]),t("td",null,[t("span",{onClick:f=>n.deleteBasket(p),class:"del-icon"},[m(_,{icon:"fa-regular fa-trash-can"})],8,kt)])]))),256))])])]),t("div",{class:"plus-icon",onClick:s[4]||(s[4]=d=>n.showProblems())},[m(_,{icon:"fa-solid fa-plus"})])]),t("div",It,[m(c,{type:"button",variant:"tonal",class:"back-button",onClick:s[5]||(s[5]=d=>n.tempDataCancle())},{default:u(()=>[Pt]),_:1}),m(c,{type:"button",class:"left-button",variant:"tonal",onClick:n.eduNewMake},{default:u(()=>[gt]),_:1},8,["onClick"])])])])):(r(),h("div",yt,[Ct,t("div",Bt,b(l.botMessage),1)]))])]))}const Ot=M(G,[["render",Dt],["__scopeId","data-v-05340fa6"]]);export{Ot as default};
