import{a as g}from"./apiService-77935b08.js";import{e as T,C as I,f as P,g as w,h as k}from"./urls-04ad3523.js";import{A}from"./auth-eef4144a.js";import{a as N}from"./axios-c24e582b.js";import{u as S}from"./setting-932355f8.js";import{_ as U,r as _,o as u,c as h,a as i,e as o,w as p,i as V,d,j as F,h as c,t as y,p as C,g as O}from"./index-e96a63ea.js";import{_ as x}from"./btn_popclose-3d27763f.js";const R={data(){return{serverFlag:!1,form:null,uid:"",upass:"",reUpass:"",name:"",pcs:"",email:"",readonlyPcs:!1,readonlyName:!1,readonlyEmail:!1,snsType:"",role:"ROLE_MEMBER",authPcs:"",upassErrorFlag:!1,authNum:"",authTimerOut:!0,authTimer:"",sendAuthFlag:!1,timeInterval:null,authActive:!1,agreeDialogShow:!1,agreeTitle:"",agreeHtml:"",marketAgree:""}},created(){const s=A.getSession();if(s&&(s!=null&&s.memberInfo)){this.$router.push("/");return}let e=!1;if(!sessionStorage.getItem("joinUid"))e=!0;else if(this.uid=sessionStorage.getItem("joinUid"),sessionStorage.getItem("snsTempJoinInfo")){const r=JSON.parse(sessionStorage.getItem("snsTempJoinInfo"));this.upass="dsd23gf",r.pcs&&(this.pcs=r.pcs.replace("-","").replace("-",""),this.readonlyPcs=!0),r.email&&(this.email=r.email,this.readonlyEmail=!0),r.name&&(this.readonlyName=!0,this.name=r.name),this.snsType=r.sns}if(e){let r={message:"The wrong approach",doAction:()=>{this.$router.push("/")}};this.emitter.emit("modalOpen",r)}this.setting=S()},methods:{setAgree(s){if(this.setting.serverResponse){const e=this.setting.agree[s];s=="privacy"?this.agreeTitle="Privacy policy":this.agreeTitle="Terms of Use",this.agreeHtml=e.content,this.agreeDialogShow=!0}},async emailCheck(s){if(this.readonlyEmail)return!0;if(!s)return"Please enter your email address";if(this.checkEmail=!1,/^[a-z0-9.-]+@[a-z.-]+\.[a-z]+$/i.test(s)){switch(g.checkBearerToken(),(await N.post(T,{uid:s},{headers:I})).data.status){case"success":this.checkEmail=!0;break}return this.checkEmail?!0:"This is a duplicate email address"}else return"Invalid email address"},authNumErrors(s){return s?!0:"Please enter your verification number"},upassErrors(s){if(this.upassErrorFlag=!1,!s)return"Please enter a password";if(s.length<6||s.length>20)return"Please enter a password between 6 and 20 characters.";let e=/\d{1}/,r=e.test(s);return r?(e=/[a-zA-Z]/,r=e.test(s),r?(e=/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/,r=e.test(s),r?(this.upassErrorFlag=!0,"You cannot use Korean in your password."):!0):(this.upassErrorFlag=!0,"Password must contain English letters")):(this.upassErrorFlag=!0,"Password must contain at least one number")},reUpassErrors(s){return this.upassErrorFlag=!1,s?this.upass!=s?(this.upassErrorFlag=!0,"Password and password confirmation are different"):!0:"Please re-enter your password"},pcsErrors(s){return s?isNaN(s)?"Only numbers can be entered as a mobile phone number.":(s.length>11&&(this.pcs=s.substring(0,11)),!0):"Please enter your mobile phone number"},sendAuthNum(){if(!this.pcs){this.emitter.emit("modalOpen",{message:"Please enter your mobile phone number"});return}if(isNaN(this.pcs)){this.emitter.emit("modalOpen",{message:"Invalid mobile phone number format"});return}if(this.pcs.length>11){this.emitter.emit("modalOpen",{message:"Invalid mobile phone number format"});return}this.emitter.emit("overlay","open"),this.serverFlag=!0,g.post(P,{pcs:this.pcs.toString()},s=>{this.serverFlag=!1,this.emitter.emit("overlay","hide");let e=s.status,r={};this.authTimerOut=!0,e=="success"?(r={message:"A verification number has been sent"},this.setTime(),this.sendAuthFlag=!0):(this.sendAuthFlag=!1,s.code=="double"?r={message:"This is a mobile phone number that has already been registered."}:r={message:"Failed to send authentication numbe"}),this.emitter.emit("modalOpen",r)})},checkAuthNum(){if(!this.authActive){this.emitter.emit("modalOpen",{message:"Authentication expiration time has passed"});return}if(!this.pcs){this.emitter.emit("modalOpen",{message:"Please enter your mobile phone number"});return}this.emitter.emit("overlay","open"),this.serverFlag=!0,g.post(w,{pcs:this.pcs.toString(),authNumber:this.authNum},s=>{this.serverFlag=!1,this.emitter.emit("overlay","hide");let e=s.status,r={};e=="success"?(this.authPcs=this.pcs,this.timeInterval&&clearInterval(this.timeInterval),r={message:"The authentication number has been confirmed."}):(this.authPcs="",r={message:"This is an incorrect authentication number."}),this.emitter.emit("modalOpen",r)})},setTime(){this.timeInterval&&clearInterval(this.timeInterval);let s=180;this.authTimer="3:00",this.authActive=!0,this.timeInterval=setInterval(()=>{if(s--,s<1)this.authActive=!1,clearInterval(this.timeInterval);else{const e=parseInt(s/60);let r=s%60;r<10&&(r="0"+r),this.authTimer=e+":"+r}},1e3)},validate(){if(this.serverFlag||this.upassErrorFlag||!this.form)return;if(!this.readonlyPcs){if(!this.authPcs){let e={message:"Please complete mobile phone number verification"};this.emitter.emit("modalOpen",e);return}if(this.authPcs!=this.pcs){let e={message:"The verified mobile phone number and current mobile phone number are different"};this.emitter.emit("modalOpen",e);return}}const s={uid:this.uid,role:this.role,upass:this.upass,name:this.name,pcs:this.pcs.toString(),snsType:this.snsType,email:this.email,marketAgree:"no"};this.emitter.emit("overlay","open"),this.serverFlag=!0,g.post(k,s,e=>{this.serverFlag=!1,this.emitter.emit("overlay","hide");let r=e.status,f={};if(r=="success")switch(e.code){case"emailAuth":case"auth":f={message:"Congratulations on signing up",doAction:()=>{sessionStorage.setItem("joinRole",""),sessionStorage.setItem("joinUid",""),this.$router.push("/memberLogin")}};break}else{let t="";switch(e.code){case"doubleUid":t="This is a duplicate ID.";break;case"doubleEmail":t="This is a duplicate email";break;case"doublePcs":t="This is a mobile phone number that has already been registered.";break;default:t="The wrong approach";break}f={message:t}}this.emitter.emit("modalOpen",f)})}},beforeUnmount(){this.timeInterval&&clearInterval(this.timeInterval)}},l=s=>(C("data-v-ce14fe75"),s=s(),O(),s),B={class:"login-container"},H={class:"login-container-inner"},M=l(()=>i("p",{class:"page-title"},"Join the membership",-1)),D=l(()=>i("div",{class:"sub-title"}," Enter personal information",-1)),j={class:"input-ul"},L={key:0},z=l(()=>i("div",{class:"label"},"Password",-1)),J={key:1},K=l(()=>i("div",{class:"label"},"confirm password",-1)),G=l(()=>i("div",{class:"label"},"Name",-1)),q={key:2},W=l(()=>i("div",{class:"label"}," Email",-1)),Y=l(()=>i("div",{class:"label"}," Cell phone",-1)),Z={class:"auth-box"},Q=l(()=>i("span",null," Send authentication number",-1)),X={key:3},$={class:"label"},ee={key:0,class:"auth-timer"},se={class:"auth-box"},te=l(()=>i("span",null,"Check authentication number",-1)),re={class:"button-row"},ie={class:"agree-box"},ae={class:"text"},ne={class:"modal-layout"},oe={class:"modal-header"},le={class:"modal-title"},ue={class:"modal-body"},me=["innerHTML"];function he(s,e,r,f,t,n){const m=_("v-text-field"),v=_("v-btn"),b=_("v-form"),E=_("v-dialog");return u(),h("div",B,[i("div",H,[M,o(b,{modelValue:t.form,"onUpdate:modelValue":e[11]||(e[11]=a=>t.form=a),novalidate:"",onSubmit:V(n.validate,["prevent"])},{default:p(()=>[D,i("ul",j,[t.snsType?d("",!0):(u(),h("li",L,[z,o(m,{type:"password",variant:"outlined",autocomplete:"on",modelValue:t.upass,"onUpdate:modelValue":e[0]||(e[0]=a=>t.upass=a),rules:[n.upassErrors],density:"compact",placeholder:"Please enter a password"},null,8,["modelValue","rules"])])),t.snsType?d("",!0):(u(),h("li",J,[K,o(m,{type:"password",variant:"outlined",autocomplete:"on",modelValue:t.reUpass,"onUpdate:modelValue":e[1]||(e[1]=a=>t.reUpass=a),rules:[n.reUpassErrors],density:"compact",placeholder:"Please re-enter your password"},null,8,["modelValue","rules"])])),i("li",null,[G,o(m,{variant:"outlined",density:"compact",rules:[!!t.name||"Please enter your name"],placeholder:"Please enter your name",readonly:t.readonlyName,modelValue:t.name,"onUpdate:modelValue":e[2]||(e[2]=a=>t.name=a)},null,8,["rules","readonly","modelValue"])]),t.snsType?(u(),h("li",q,[W,o(m,{variant:"outlined",density:"compact",readonly:t.readonlyEmail,rules:[n.emailCheck],placeholder:"Please enter your email",modelValue:t.email,"onUpdate:modelValue":e[3]||(e[3]=a=>t.email=a)},null,8,["readonly","rules","modelValue"])])):d("",!0),i("li",null,[Y,i("div",Z,[o(m,{variant:"outlined",density:"compact",rules:[n.pcsErrors],placeholder:"Please enter only numbers without '-'",readonly:t.readonlyPcs,modelValue:t.pcs,"onUpdate:modelValue":e[4]||(e[4]=a=>t.pcs=a)},null,8,["rules","readonly","modelValue"]),t.readonlyPcs?d("",!0):(u(),F(v,{key:0,type:"button",variant:"outlined",class:"pscSendButton",onClick:e[5]||(e[5]=a=>n.sendAuthNum())},{default:p(()=>[Q]),_:1}))])]),t.readonlyPcs?d("",!0):(u(),h("li",X,[i("div",$,[c("Certification Number "),t.sendAuthFlag?(u(),h("span",ee,[c(" (Time remaining: "+y(t.authTimer)+") ",1),i("span",{onClick:e[6]||(e[6]=a=>n.sendAuthNum())},"Re-request")])):d("",!0)]),i("div",se,[o(m,{variant:"outlined",density:"compact",rules:[n.authNumErrors],placeholder:`\r
Please enter your verification number`,modelValue:t.authNum,"onUpdate:modelValue":e[7]||(e[7]=a=>t.authNum=a)},null,8,["rules","modelValue"]),o(v,{type:"button",variant:"outlined",color:"blue",class:"pscSendButton",onClick:e[8]||(e[8]=a=>n.checkAuthNum())},{default:p(()=>[te]),_:1})])]))]),i("div",re,[o(v,{type:"submit",class:"blackButton"},{default:p(()=>[c(" Sing up ")]),_:1})]),i("div",ie,[i("div",ae,[c(" * When registering as a member, you agree to the "),i("span",{onClick:e[9]||(e[9]=a=>n.setAgree("use"))},"Terms of Use"),c(" and the "),i("span",{onClick:e[10]||(e[10]=a=>n.setAgree("privacy"))},"Privacy policy"),c(" see. ")])])]),_:1},8,["modelValue","onSubmit"])]),o(E,{modelValue:t.agreeDialogShow,"onUpdate:modelValue":e[13]||(e[13]=a=>t.agreeDialogShow=a),persistent:"",style:{"z-index":"1000000",width:"1000px","max-width":"98%",margin:"auto"}},{default:p(()=>[i("div",ne,[i("div",oe,[i("div",le,y(t.agreeTitle),1),i("img",{src:x,onClick:e[12]||(e[12]=a=>t.agreeDialogShow=!1)})]),i("div",ue,[i("div",{class:"agree-html",innerHTML:t.agreeHtml},null,8,me)])])]),_:1},8,["modelValue"])])}const ye=U(R,[["render",he],["__scopeId","data-v-ce14fe75"]]);export{ye as default};
