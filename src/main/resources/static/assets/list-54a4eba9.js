import{a as _}from"./apiService-77935b08.js";import{r as y}from"./urls-04ad3523.js";import{p as b}from"./paging-4698e803.js";import{e as v}from"./eduAction-d64f11a0.js";import{u as k}from"./setting-932355f8.js";import{_ as T,m as I,r as p,o as r,c as l,a as e,t as n,j as x,d as w,F as d,b as g,e as S,p as C,g as B}from"./index-e96a63ea.js";import"./jquery-d8551b6e.js";import{U as L}from"./util-75dcb7cf.js";import{S as N}from"./search-4f2fc610.js";import"./axios-c24e582b.js";import"./auth-eef4144a.js";const D={name:"contentList",components:{paging:b,SEARCH:N},computed:{...I(v,["leftMenuList"])},watch:{$route(t,s){t.name=="contentList"&&(this.page=1,this.searchType=this.$route.params.typeId,this.subId=this.$route.params.subId,this.id=this.$route.params.id,this.$route.params.textBook!="none"?this.textBookCode=this.$route.params.textBook:this.textBookCode="",this.setNaviTitle(),this.getData())},leftMenuList(t){t.length>0&&this.setNaviTitle()}},data(){return{settingflag:!1,searchType:"",problemList:[],subId:"",id:"",textBookCode:"",page:1,limit:20,pageGroup:10,pcView:!0,paging:{},pagingReload:!1,naviTitle:"",schoolTypeItems:{},gradeItems:{},gtypeItems:{},gtype:"",schType:"",grd:"",keyword:""}},created(){if(window.document.body.clientWidth<=1023&&(this.pcView=!1,this.pageGroup=4),this.searchType=this.$route.params.typeId,this.subId=this.$route.params.subId,this.id=this.$route.params.id,this.$route.params.textBook!="none"?this.textBookCode=this.$route.params.textBook:this.textBookCode="",this.leftMenuList.length>0&&this.setNaviTitle(),this.setting=k(),this.setting.serverResponse)this.setSetting(),this.getData();else{const t=setInterval(()=>{this.setting.serverResponse&&(this.setSetting(),this.getData(),clearInterval(t))},100)}},methods:{setSetting(){this.settingflag=!0,this.gtypeItems=this.setting.gtypes,this.schoolTypeItems=this.setting.schoolTypes},setNaviTitle(){let t="";for(const s of this.leftMenuList)if(s.id==this.searchType){t=s.text;for(const i of s.items)if(i.value==this.subId&&(t+=" > "+i.title,this.id!="none")){for(const h of i.items)if(h.value==this.id&&(t+=" > "+h.title,this.textBookCode&&h.items))for(const a of h.items)a.value==this.textBookCode&&(t+=" > "+a.title)}}this.naviTitle=t},getData(t){const s="student";let i={};switch(this.searchType){case"all":i={page:this.page.toString(),limit:this.limit.toString(),searchType:this.searchType,actTarget:s,gtype:this.gtype,schType:this.schType,grd:this.grd,keyword:this.keyword,textBookCode:this.textBookCode};break;default:i={id:this.id,subId:this.subId,page:this.page.toString(),limit:this.limit.toString(),searchType:this.searchType,actTarget:s,textBookCode:this.textBookCode};break}t=="search"&&this.emitter.emit("overlay","open"),_.post(y,i,h=>{t=="search"&&this.emitter.emit("overlay","hide"),this.setProblemList(h),this.paging={total:h.total,currentPage:this.page,pageGroup:this.pageGroup,limit:this.limit},this.pagingReload=!0,setTimeout(()=>{this.pagingReload=!1},500)})},doSearch(t){this.page=1,this.searchType="all",this.gtype=t.gtype,this.schType=t.schoolType,this.grd=t.grade.toString(),this.textBookCode=t.textbook,this.keyword=t.keyword,this.getData("search")},setProblemList(t){this.problemList=[];for(let s of t.list){s.gtype=this.gtypeItems[s.gtype.toString()];let i=L.getSchoolTypeInfo(s,this.schoolTypeItems);s.schoolInfo=i.info,s.textbookName=i.book,this.problemList.push(s)}},pageMove(t){this.page=t.page,this.getData()},goPage(t){this.$router.push("/contentItem/"+this.searchType+"/"+this.subId+"/"+this.id+"/"+t)}},mounted(){window.addEventListener("resize",()=>{window.document.body.clientWidth<=1023?this.pcView=!1:this.pcView=!0})},beforeUnmount(){window.removeEventListener("resize",()=>{window.document.body.clientWidth<=1023?this.pcView=!1:this.pcView=!0})}},R=t=>(C("data-v-549f95f5"),t=t(),B(),t),V={class:"content-box",id:"edulist-content-box"},E={class:"page-body"},M={class:"page-title"},P={key:1,class:"edu-table",cellspacing:"0",cellpadding:"0",border:"0"},j=R(()=>e("thead",null,[e("tr",null,[e("th",{style:{width:"150px"}},"학교급"),e("th",{style:{width:"150px"}},"주제"),e("th",{style:{width:"150px"}},"교과명"),e("th",null,"학습주제")])],-1)),$=["onClick"],A={class:"subject-box"},G={class:"subject"},U={key:2,class:"edu-ul"},H=["onClick"],W={class:"subject-box"},z={class:"subject"},F={class:"part"},O={class:"button-box"},q={class:"part"};function J(t,s,i,h,a,c){const u=p("SEARCH"),m=p("paging");return r(),l("div",V,[e("div",E,[e("div",M,n(a.naviTitle),1),a.settingflag?(r(),x(u,{key:0,onDoSearch:c.doSearch},null,8,["onDoSearch"])):w("",!0),a.pcView?(r(),l("table",P,[j,e("tbody",null,[(r(!0),l(d,null,g(a.problemList,o=>(r(),l("tr",{onClick:f=>c.goPage(o.id)},[e("td",null,n(o.schoolInfo),1),e("td",null,n(o.gtype),1),e("td",null,n(o.textbookName),1),e("td",A,[e("div",G,n(o.subject),1)])],8,$))),256))])])):(r(),l("ul",U,[(r(!0),l(d,null,g(a.problemList,o=>(r(),l("li",{onClick:f=>c.goPage(o.id)},[e("div",W,[e("div",z,n(o.subject),1),e("div",F,n(o.schoolInfo)+" / "+n(o.gtype),1)]),e("div",O,[e("div",q,n(o.textbookName),1)])],8,H))),256))])),S(m,{paging:a.paging,reload:a.pagingReload,onPageMove:c.pageMove},null,8,["paging","reload","onPageMove"])])])}const nt=T(D,[["render",J],["__scopeId","data-v-549f95f5"]]);export{nt as default};
