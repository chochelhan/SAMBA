import{a as A}from"./apiService-77935b08.js";import{l as I,m as D,n as F,o as J}from"./urls-04ad3523.js";import{A as M}from"./auth-eef4144a.js";import{U as v}from"./util-75dcb7cf.js";import{J as f}from"./jquery-d8551b6e.js";import{_ as Q,O as G,A as z,a as O,b as P,c as H}from"./send-01-396157f3.js";import{_ as K,r as p,o as a,c as d,a as e,e as h,h as L,k as y,v as b,w as u,l as j,F as C,b as S,i as U,q as Y,n as T,d as k,t as x,p as Z,g as X}from"./index-e96a63ea.js";import{_ as q}from"./btn_popclose-3d27763f.js";import"./axios-c24e582b.js";const W="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAE8SURBVHgB3ZNLUsJAEIb/GdRyGU9gvAHhApC1VWqWPqqUk6AnsDxBqrSiy1EvIF7A4QaON8jaR8ZuTYBAAiSsoBdJZzr9zf/PA1i7CJV27pTulNUFKsSt0hdS4JpShxqNtPCPA8/UAqawMP2My6CyKkwIXH5Z7FE6sICbCLxUUjgJOz30rjiPlG5aAc05TbDTDbx4rsIy2IPSLklRnJPKfgabCZwFY5tsl21/WwSYZ3lRGFn1x9UVApeBTQH5wIp01+rAOHJrSJDeMrApIEWTH58JburAcpazc0XNhnbO3wI6VO1VgXFsZElCjeJ/BndT4N2O/vmDbdNVix51SOPOJKRh0c2u3xAoJXbtiBITuE/0AdtnZdGTPqf6UZGqH4k2vUzOMsf981s7acCc7bc+ihq5XjR+ctB6xcrEL646vxid08fhAAAAAElFTkSuQmCC",$="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADLSURBVHgB7ZPBDcIwDEWdiANjlBE6AhvAMeLEZJwQR9iAEToCGQS12FVA0a9tUfVaS1Gj5P+X1HaI1lgaAReuj+4l3zjQPh3brJlu967pAz1lfjq0u3ovorjnMRCNBjFasFGjHDYBvvlmLM4atIaJRrToD8ohdGHjho282fDIsRgRdlZSogI1KJVUeDAXiNACdGES0QNuQRDLmhfmDbEARfzLaZrzy1Y1sVDpn6JosG/OtOojdNrYTmvIHPsU/dZLMatZQ7WXssby+ABx6JYOHEoBkQAAAABJRU5ErkJggg==";const tt={components:{CustomScrollbar:Q},watch:{all(s){this.deleteItems=[];for(let t of this.list)s&&this.deleteItems.push(t.id)}},data(){return{uid:"",util:v,id:"",form:null,keyword:"",chatList:[],azureGptApiKey:"ed7f1ac91cda45c3be7b6b10d77a5900",azureGptEndpoint:"https://aimentor.openai.azure.com/",azureGptdeploymentId:"gpt-35-turbo-16k",azureGptApiVersion:"2023-07-01-preview",gptResponseFlag:!1,gptUserQuestions:[{role:"system",content:"You are a helpful assistant."}],list:[],orgList:{},tempId:"",updIndex:"",updDialogShow:!1,updForm:null,title:"",editShow:!1,all:"",deleteItems:[],height:"500px",updKey:""}},created(){const s=M.getSession();if(!s||!s.memberInfo){location.href="/";return}this.uid=s.memberInfo.uid,this.getList()},methods:{setUserMessage(s){let t={role:"user",content:s};this.gptUserQuestions.push(t),this.chatList.push(t),t={role:"assistant",content:""},this.chatList.push(t),this.getChatResponse(this.chatList.length-1)},getChatResponse(s){if(this.gptResponseFlag)return;this.messageResult=!0,this.gptResponseFlag=!0;const t=new G(this.azureGptEndpoint,new z(this.azureGptApiKey)),c=this.azureGptdeploymentId;t.getChatCompletions(c,this.gptUserQuestions,{"api-version":this.azureGptApiVersion}).then(o=>{this.gptResponseFlag=!1;const m={role:"assistant",content:o.choices[0].message.content};this.gptUserQuestions.push(m),this.chatList[s]=m,this.saveTemp("save")},o=>{this.gptResponseFlag=!1,console.log(o)})},validate(){this.keyword&&(this.gptResponseFlag||(this.setUserMessage(this.keyword),this.keyword=""))},newChat(){this.updKey="";for(const s in this.orgList)if(this.orgList[s].show=="none"&&!this.updKey){if(this.orgList[s].list.length<1)return;this.orgList[s].show="show",this.orgList[s].summary="Persona sLLM",this.orgList[s].title=="New chat"&&(this.orgList[s].title=this.orgList[s].list[0].content),this.updKey=s}this.saveTemp("init");for(let s of this.list)this.tempId==s.id&&(s.show="show",s.title=this.orgList[this.tempId].title,s.summary=this.orgList[this.tempId].summary),s.active="";this.setMessageInit()},setMessageInit(){this.keyword="",this.gptUserQuestions=[{role:"system",content:"You are a helpful assistant."}],this.chatList=[]},saveTemp(s){let t={};const l=new Date().getTime();s=="init"?(this.updKey&&this.orgList[this.updKey]?(t.oldChatId=this.updKey,t.oldSummary=this.orgList[this.updKey].summary,t.oldTitle=this.orgList[this.updKey].title,t.oldShow="show",t.updateType="updateAndInsert"):t.updateType="insert",this.tempId=l.toString().replace(".","_"),t.chatId=this.tempId,t.summary="Let’s start chat",t.title="New chat",t.show="none",t.date=v.getTimeFormat(l),t.list=""):t={chatId:this.tempId,updateType:"listUpd",list:JSON.stringify(this.chatList)},A.post(I,t,o=>{if(s=="init"){const n={id:this.tempId,summary:"Let’s start chat",title:"New chat",show:"none",date:v.getTimeFormat(l),list:[]};this.list.unshift(n),this.orgList[this.tempId]=n}else this.orgList[this.tempId].list=this.chatList})},getList(){this.list=[],A.post(D,{},s=>{let t=!0;if(s.info){this.orgList=JSON.parse(s.info);for(const c in this.orgList){let l=this.orgList[c];l.id=c,l.show=="none"&&t&&(t=!1,this.tempId=c),l.list?l.list=JSON.parse(l.list):l.list=[],l.active=l.show=="none"?"active":"",this.list.unshift(l)}}t&&this.saveTemp("init")})},setAiMessage(s){if(this.tempId=s.id,this.setMessageInit(),this.orgList[this.tempId].list)for(const t of this.orgList[this.tempId].list)this.gptUserQuestions.push(t),this.chatList.push(t);for(let t of this.list)t.id==s.id?t.active="active":t.active=""},modifyList(s){let t=this.list[s];this.updIndex=s,this.title=t.title,this.updDialogShow=!0},updValidate(){if(this.updForm){let s=this.list[this.updIndex];s.title=this.title,s.id;const t={chatId:s.id,title:s.title,summary:s.summary,updateType:"titleUpd"};A.post(I,t,c=>{this.updDialogShow=!1})}},deleteList(s){const t={type:"confirm",message:"Are you sure you want to delete the selected items?",doAction:()=>{const l=this.list[s].id;A.post(F,{chatId:l.toString()},o=>{this.setMessageInit(),this.getList()})}};this.emitter.emit("modalOpen",t)},editToggle(){this.editShow=!this.editShow,this.editShow?this.height=f(window).height()-205+"px":this.height=f(window).height()-240+"px"},deleteAll(){if(this.deleteItems.length<1){this.emitter.emit("modalOpen",{message:"No target selected"});return}const s={type:"confirm",message:"Are you sure you want to delete the selected items?",doAction:()=>{A.post(J,{chatIds:this.deleteItems},t=>{this.setMessageInit(),this.getList(),this.editShow=!1})}};this.emitter.emit("modalOpen",s)}},mounted(){},updated(){f("html,body").animate({scrollTop:f("body").prop("scrollHeight")},500)}},r=s=>(Z("data-v-9eac7b1d"),s=s(),X(),s),st={class:"content-layout"},et={class:"left"},it={class:"left-header"},ot={key:0,class:"edit-area"},lt={class:"left-button-box"},nt={class:"list-button"},at=r(()=>e("span",null,"Delete",-1)),dt={key:1},rt=r(()=>e("span",null,"New Chat",-1)),ht={class:"left-button-box"},ct=r(()=>e("div",{class:"list-button"},"Chat List",-1)),pt=r(()=>e("span",null,"Edit",-1)),ut={class:"list-ul"},mt={key:0,class:"check-box"},At=["value"],_t=["onClick"],gt={class:"summary"},ft={class:"name"},vt={class:"over-button"},yt=["onClick"],wt=r(()=>e("img",{src:W},null,-1)),It=[wt],Lt=["onClick"],bt=r(()=>e("img",{src:$},null,-1)),Ct=[bt],St={class:"content"},Ut={class:"ai-area"},Tt={key:0,class:"empty"},kt=r(()=>e("img",{src:O},null,-1)),xt=r(()=>e("div",{class:"text"},"Let’s start chat!",-1)),Rt=[kt,xt],Et={key:1,class:"ai-chat-ul"},Vt={key:0,class:"robot"},Nt=r(()=>e("img",{src:P},null,-1)),Bt={key:1},Dt=["innerHTML"],Ft={class:"input-box"},Jt=r(()=>e("button",{type:"submit"},[e("img",{src:H})],-1)),Mt=r(()=>e("div",{class:"blur-area"},null,-1)),Qt={class:"modal-layout"},Gt={class:"modal-header"},zt=r(()=>e("div",{class:"modal-title"},"Edit title",-1)),Ot={class:"modal-body"},Pt={class:"input-box"},Ht={class:"button-row"},Kt=r(()=>e("span",null,"Submit",-1));function jt(s,t,c,l,o,n){const m=p("font-awesome-icon"),_=p("v-btn"),R=p("custom-scrollbar"),E=p("v-progress-circular"),V=p("v-text-field"),N=p("v-form"),B=p("v-dialog");return a(),d("div",null,[e("div",st,[e("div",et,[e("div",it,[o.editShow?(a(),d("div",ot,[e("div",{class:"edit-title",onClick:t[0]||(t[0]=i=>n.editToggle())},[h(m,{class:"icon",icon:"fa-solid fa-chevron-left"}),L(" Edit ")]),e("div",lt,[e("div",nt,[y(e("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=i=>o.all=i),value:"all"},null,512),[[b,o.all]])]),h(_,{class:"edit-button",onClick:t[2]||(t[2]=i=>n.deleteAll()),variant:"outlined"},{default:u(()=>[at]),_:1})])])):(a(),d("div",dt,[h(_,{elevation:1,class:"new-button",color:"#1429A1",onClick:t[3]||(t[3]=i=>n.newChat())},{default:u(()=>[h(m,{class:"icon",icon:"fa-solid fa-plus"}),rt]),_:1}),e("div",ht,[ct,h(_,{class:"edit-button",onClick:t[4]||(t[4]=i=>n.editToggle()),variant:"outlined"},{default:u(()=>[pt]),_:1})])]))]),h(R,{style:j({width:"280px",height:o.height})},{default:u(()=>[e("ul",ut,[(a(!0),d(C,null,S(o.list,(i,w)=>(a(),d("li",{key:o.id,class:T(i.active)},[o.editShow?(a(),d("div",mt,[y(e("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=g=>o.deleteItems=g),value:i.id},null,8,At),[[b,o.deleteItems]])])):k("",!0),e("div",{class:"value-box",onClick:g=>n.setAiMessage(i)},[e("div",gt,x(i.summary),1),e("div",ft,x(i.title),1),e("div",vt,[e("span",{onClick:g=>n.modifyList(w)},It,8,yt),e("span",{onClick:g=>n.deleteList(w)},Ct,8,Lt)])],8,_t)],2))),128))])]),_:1},8,["style"])]),e("div",St,[e("div",Ut,[o.chatList.length<1?(a(),d("div",Tt,Rt)):(a(),d("ul",Et,[(a(!0),d(C,null,S(o.chatList,i=>(a(),d("li",{class:T(i.role)},[i.role=="assistant"?(a(),d("div",Vt,[Nt,L(" Your Assistant ")])):k("",!0),i.content?(a(),d("span",{key:2,innerHTML:o.util.nl2brContent(i.content)},null,8,Dt)):(a(),d("span",Bt,[h(E,{indeterminate:"",color:"#9FA8DA"})]))],2))),256))])),e("form",{novalidate:"",onSubmit:t[7]||(t[7]=U((...i)=>n.validate&&n.validate(...i),["prevent"]))},[e("div",Ft,[y(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=i=>o.keyword=i),placeholder:"Ask me anything"},null,512),[[Y,o.keyword]]),Jt]),Mt],32)])])]),h(B,{modelValue:o.updDialogShow,"onUpdate:modelValue":t[11]||(t[11]=i=>o.updDialogShow=i),persistent:"",style:{"z-index":"1000000","max-width":"98%",width:"600px",margin:"auto"}},{default:u(()=>[e("div",Qt,[e("div",Gt,[zt,e("img",{src:q,onClick:t[8]||(t[8]=i=>o.updDialogShow=!1)})]),e("div",Ot,[h(N,{modelValue:o.updForm,"onUpdate:modelValue":t[10]||(t[10]=i=>o.updForm=i),novalidate:"",class:"w-full",onSubmit:U(n.updValidate,["prevent"])},{default:u(()=>[e("div",Pt,[h(V,{modelValue:o.title,"onUpdate:modelValue":t[9]||(t[9]=i=>o.title=i),rules:[i=>!!i||"Please enter a title"],variant:"outlined",placeholder:"Please enter a title"},null,8,["modelValue","rules"])]),e("div",Ht,[h(_,{type:"submit",class:"btn",variant:"tonal"},{default:u(()=>[Kt]),_:1})])]),_:1},8,["modelValue","onSubmit"])])])]),_:1},8,["modelValue"])])}const is=K(tt,[["render",jt],["__scopeId","data-v-9eac7b1d"]]);export{is as default};
