import{r as x,u as G}from"./xlsx-04f2268f.js";import{w as S}from"./realTimeEdu-31352dc5.js";import{m as A,_ as R,r as v,o as d,c as h,a as r,n as L,e as g,w as m,j as k,d as p,F as b,b as _,k as T,q as U,p as B,g as I}from"./index-e96a63ea.js";import{U as C}from"./util-75dcb7cf.js";const V={props:["chartDatas","userGraphData","viewType","isLogin","isGraphData"],computed:{...A(S,["prohibitList"])},data(){return{rows:[],datas:[],graphType:["bar"],graphTitle:"",labelUse:"no"}},created(){var l;try{this.isGraphData.labelUse&&(this.labelUse=this.isGraphData.labelUse,this.graphType=this.isGraphData.graphTypes,this.graphTitle=this.isGraphData.graphTitle)}catch{}if(!!((l=this.userGraphData)!=null&&l.graphType)){for(const a of this.userGraphData.data){const s=[];for(const t of a)s.push(t);this.datas.push(s)}for(const a of this.userGraphData.label)this.rows.push(a)}else if(this.labelUse=="yes"){this.rows=[];const a=[];for(const s of this.isGraphData.rows)this.rows.push(s),a.push("");this.datas.push(a)}else{const a=[];for(let s=0;s<2;s++)this.rows.push(""),a.push("");this.datas.push(a)}},methods:{setSample(){this.rows=["연도","선수","홈런수"],this.datas=[["2011","김",30],["2012","최",40],["2013","박",50]]},excelUpload(){this.$refs.fileupload.click()},async uploadActive(e){const a=await e.target.files[0].arrayBuffer();try{const s=x(a),t=s.Sheets[s.SheetNames[0]],c=G.sheet_to_json(t);if(this.labelUse!="yes")this.rows=[];else for(const u of c){let i=0;for(const o in u)i++;if(i!=this.rows.length){this.emitter.emit("modalOpen",{message:"This is an incorrectly formatted file."});return}}let n=0;this.datas=[];for(const u of c){let i=[];for(const o in u)n<1&&this.labelUse!="yes"&&this.rows.push(o),i.push(u[o]);this.datas.push(i),n++}}catch(s){console.log(s),this.emitter.emit("modalOpen",{message:"This is an incorrectly formatted file."})}this.$refs.fileupload.value=""},addRows(){this.rows.push("");for(let e of this.datas)e.push("")},addCols(){const e=[];for(const l in this.datas[0])e.push("");this.datas.push(e)},deleteRows(e){this.rows.splice(e,1);for(let l of this.datas)l.splice(e,1)},deleteCols(e){this.datas.splice(e,1)},sendData(){if(!this.isLogin){this.$router.push("/memberLoginIntro");return}let e=!1,l=1,a="",s=!0;for(const n of this.rows){if(a="label_"+l,!n||n==""){e=!0;break}else if(s=C.checkProhibitByWord(n.toString(),this.prohibitList),!s)break;l++}let t={};if(!s){t={message:"Please use positive language based on respect and courtesy.",doAction:()=>{setTimeout(()=>{this.$refs[a][0].focus()},100)}},this.emitter.emit("modalOpen",t);return}if(e){t={message:"Please enter your data",doAction:()=>{setTimeout(()=>{this.$refs[a][0].focus()},100)}},this.emitter.emit("modalOpen",t);return}if(!e&&s){let n=1;for(const u of this.datas){let i=1;for(const o of u){if(a="data_"+n+"_"+i,!o||o==""){e=!0;break}else if(s=C.checkProhibitByWord(o.toString(),this.prohibitList),!s)break;i++}if(e||!s)break;n++}}if(!s){t={message:"Please use positive language based on respect and courtesy.",doAction:()=>{setTimeout(()=>{this.$refs[a][0].focus()},100)}},this.emitter.emit("modalOpen",t);return}if(e){t={message:"Please enter your data",doAction:()=>{setTimeout(()=>{this.$refs[a][0].focus()},100)}},this.emitter.emit("modalOpen",t);return}const c={label:this.rows,data:this.datas,graphType:this.graphType,graphTitle:this.graphTitle};this.$emit("resultGraphData",c)}}},y=e=>(B("data-v-6f882b84"),e=e(),I(),e),O={class:"table-layout"},P={class:"data-table-box"},N=y(()=>r("span",null,"Add row",-1)),F=y(()=>r("span",null,"Add column",-1)),M=y(()=>r("span",null,"Excel upload",-1)),E={class:"data-table",cellpadding:"0",cellspacing:"0",border:"0"},W={key:0,class:"btn-thead"},j={class:"normal-thead"},q=["readonly","onUpdate:modelValue"],z=["onUpdate:modelValue"],K={class:"del-td"},H={key:0,class:"graph-btn-box"},J=y(()=>r("span",null,"Graph generated",-1));function Q(e,l,a,s,t,c){const n=v("v-btn"),u=v("font-awesome-icon");return d(),h("div",O,[r("div",P,[r("div",{class:L("add-btn-box "+t.labelUse)},[g(n,{class:"cols-add-btn",variant:"tonal",onClick:l[0]||(l[0]=i=>c.addCols())},{default:m(()=>[N]),_:1}),t.labelUse!="yes"?(d(),k(n,{key:0,class:"rows-add-btn",variant:"tonal",onClick:l[1]||(l[1]=i=>c.addRows())},{default:m(()=>[F]),_:1})):p("",!0),g(n,{class:"excel-add-btn",variant:"tonal",onClick:l[2]||(l[2]=i=>c.excelUpload())},{default:m(()=>[M]),_:1}),r("input",{style:{display:"none"},type:"file",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onChange:l[3]||(l[3]=(...i)=>c.uploadActive&&c.uploadActive(...i)),ref:"fileupload"},null,544)],2),r("table",E,[t.labelUse!="yes"?(d(),h("thead",W,[r("tr",null,[(d(!0),h(b,null,_(t.rows,(i,o)=>(d(),h("th",null,[o>1?(d(),k(u,{key:0,onClick:f=>c.deleteRows(o),class:"icon",icon:"fa-solid fa-circle-xmark"},null,8,["onClick"])):p("",!0)]))),256))])])):p("",!0),r("thead",j,[r("tr",null,[(d(!0),h(b,null,_(t.rows,(i,o)=>(d(),h("th",null,[T(r("input",{type:"text",readonly:t.labelUse=="yes","onUpdate:modelValue":f=>t.rows[o]=f,ref_for:!0,ref:"label_"+(o+1)},null,8,q),[[U,t.rows[o]]])]))),256))])]),r("tbody",null,[(d(!0),h(b,null,_(t.datas,(i,o)=>(d(),h("tr",null,[(d(!0),h(b,null,_(i,(f,w)=>(d(),h("td",null,[T(r("input",{type:"text","onUpdate:modelValue":D=>t.datas[o][w]=D,ref_for:!0,ref:"data_"+(o+1)+"_"+(w+1)},null,8,z),[[U,t.datas[o][w]]])]))),256)),r("td",K,[o>0?(d(),k(u,{key:0,class:"icon",onClick:f=>c.deleteCols(o),icon:"fa-regular fa-circle-xmark"},null,8,["onClick"])):p("",!0)])]))),256))])])]),a.viewType!="readonly"?(d(),h("div",H,[g(n,{class:"graph-btn",variant:"tonal",type:"button",onClick:c.sendData},{default:m(()=>[J]),_:1},8,["onClick"])])):p("",!0)])}const ee=R(V,[["render",Q],["__scopeId","data-v-6f882b84"]]);export{ee as M};
