import{C as F,p as G,a as O,b as B,L as E,c as P,d as K,P as j,e as z}from"./index-0cc4ea83.js";import{a as R,P as q}from"./urls-dc95fcef.js";import{U as H}from"./util-75dcb7cf.js";import{_ as J,r as g,o as _,c as T,a as d,e as c,w as L,n as S,j as Y,d as N,h as V,p as Q,g as W}from"./index-e96a63ea.js";import"./axios-c24e582b.js";import"./apiService-77935b08.js";import"./urls-04ad3523.js";import"./auth-eef4144a.js";F.register(G,O,B,E,P,K,j);const X={components:{LineChartGenerator:z},data(){return{util:H,chartData:{labels:[],datasets:[]},chartOptions:{responsive:!0,maintainAspectRatio:!1},chartShow:!1,height:300,dateClass:{year:"",month:"",day:"active"},dateType:"day",stdate:"",endate:"",stmonth:"",enmonth:"",yearList:[],styear:"",enyear:"",dayList:[],label:"",useTypeList:[{title:"학생 요금제",value:"student"},{title:"교사 요금제",value:"teacher"},{title:"학교 요금제",value:"school"}],useType:"student"}},created(){this.setInit()},methods:{setInit(){const s=new Date,t=s.getFullYear(),y=s.getDate()<10?"0"+s.getDate():s.getDate();for(let u=t;u>=2010;u--)this.yearList.push({title:u+"년",value:u});this.styear=t-5,this.enyear=s.getFullYear();let o=parseInt(s.getMonth())+1;o<10&&(o="0"+o);const e=new Date(t,parseInt(s.getMonth()-1),s.getDate()),h=new Date(t,s.getMonth(),0).getDate();let l=parseInt(e.getMonth())+1;l<10&&(l="0"+l);const i=s.getDate()>h?h:y;this.stmonth=e.getFullYear()+"-"+l,this.enmonth=t+"-"+o,this.stdate=t+"-"+l+"-"+i,this.endate=t+"-"+o+"-"+y,this.getData()},getData(){if(!this.setDateList())return;this.chartShow=!1;const s={dateType:this.dateType,styear:this.styear.toString(),enyear:this.enyear.toString(),stmonth:this.stmonth.toString(),enmonth:this.enmonth.toString(),stdate:this.stdate.toString(),endate:this.endate.toString(),useType:this.useType};switch(this.dateType){case"day":this.label="["+this.stdate+" ~ "+this.endate+"]";break;case"month":this.label="["+this.stmonth+" ~ "+this.enmonth+"]";break;case"year":this.label="["+this.styear+" ~ "+this.enyear+"]";break}R.post(q,s,t=>{console.log(t),this.setGraph(t)})},setDateList(){let s,t,y=0,o=0,e="";switch(this.dateType){case"day":let r=this.stdate.split("-"),h=new Date(r[0],r[1]-1,r[2]),l=this.endate.split("-"),i=new Date(l[0],l[1]-1,l[2]);if(e=i.getTime()-h.getTime(),e<0){let a={message:"시작일은 종료일보다 같거나 작아야 합니다"};return this.emitter.emit("modalOpen",a),!1}if(this.dateType=="day"){if(Math.abs(e/864e5)>31){let m={message:"일별 통계는 기간 차이가 31일 이내여야 합니다 "};return this.emitter.emit("modalOpen",m),!1}this.dayList=[];let p=h.getFullYear(),v=i.getFullYear(),w=h.getMonth()+1,x=i.getMonth()+1;s=new Date(r[0],r[1],0).getDate();let I=h.getDate(),A=i.getDate();if(w!=x){for(let m=I;m<=s;m++){let D=m<10?"0"+m:m,b=w<10?"0"+w:w;this.dayList.push({keyDate:b+"/"+D,viewDate:p+"."+b+"."+D})}I=1}for(let m=I;m<=A;m++){let D=m<10?"0"+m:m,b=x<10?"0"+x:x;this.dayList.push({keyDate:b+"/"+D,viewDate:v+"."+b+"."+D})}}else{this.dayList=[];let a=["일","월","화","수","목","금","토"];for(let p=0;p<=6;p++)this.dayList.push(a[p])}break;case"month":if(y=parseInt(this.stmonth.replace("-","")),o=parseInt(this.enmonth.replace("-","")),e=o-y,e<0){let a={message:"시작일은 종료일보다 같거나 작아야 합니다"};return this.emitter.emit("modalOpen",a),!1}let u=this.stmonth.split("-"),k=this.enmonth.split("-"),f=parseInt(u[0]),n=parseInt(k[0]),C=parseInt(u[1]),U=parseInt(k[1]);if(this.dayList=[],e>=99){this.monthAllView=!0;for(let a=1;a<=12;a++){let p=a<10?"0"+a:a;this.dayList.push(p)}}else{if(this.monthAllView=!1,f!=n){for(let a=C;a<=12;a++){let p=a<10?"0"+a:a,v=f<10?"0"+f:f;this.dayList.push(v+"/"+p)}C=1}for(let a=C;a<=U;a++){let p=a<10?"0"+a:a,v=f<10?"0"+f:f;this.dayList.push(v+"/"+p)}}break;case"year":if(parseInt(this.styear)>parseInt(this.enyear)){let a={message:"시작일은 종료일보다 같거나 작아야 합니다"};return this.emitter.emit("modalOpen",a),!1}s=this.enyear,t=this.styear,this.dayList=[];for(let a=t;a<=s;a++){let p=a<10?"0"+a:a;this.dayList.push(p)}break}return!0},setDateType(s){this.dateType=s;for(const t in this.dateClass)t==s?this.dateClass[t]="active":this.dateClass[t]=""},search(){this.getData()},setDateText(s){let t="";switch(this.dateType){case"month":t=s.replace("/",".");break;default:t=s;break}return t},setGraph(s){const t=s.data.date.buckets;this.chartData.labels=[];const y={};let o="";for(const i of t)o=this.getIndexDateKey(i.key),i.aggregations&&(y[o]=i.aggregations.asMap.uidTotal.value);let e=[],r="";const h=[];for(const i of this.dayList)this.dateType=="day"?(r=i.keyDate,h.push(i.keyDate)):(r=i,h.push(i)),y[r]?e.push(y[r]):e.push(0);this.chartData.labels=h;let l="학생 요금제";switch(this.useType){case"school":l="학교 요금제";break;case"teacher":l="선생님 요금제";break}this.chartData.datasets=[{label:l,backgroundColor:"#00D8FF",data:e}],this.chartShow=!0},getIndexDateKey(s){let t;const o=s.split("T")[0];switch(this.dateType){case"day":return t=o.split("-"),t[1]+"/"+t[2];case"month":return console.log(this.monthAllView),t=o.split("-"),t[0]+"/"+t[1];case"year":return t=o.split("-"),t[0]}}}},M=s=>(Q("data-v-a4b55a9e"),s=s(),W(),s),Z={class:"page-container"},$={class:"product-container"},tt={style:{display:"flex"}},et={style:{width:"200px","margin-right":"10px"}},st={style:{display:"flex","justify-content":"space-between"}},at={style:{display:"flex"}},it={class:"date-box"},nt={key:0,class:"month-box"},lt={class:"day-item"},ot=M(()=>d("div",{class:"term"}," ~",-1)),rt={class:"day-item"},dt={key:1,class:"month-box"},ht=M(()=>d("div",{class:"term"}," ~",-1)),pt={key:2,class:"year-box"},mt=M(()=>d("span",null," ~ ",-1)),ct={class:"button-box"},yt={class:"graph-box"},ut={style:{"max-height":"700px",overflow:"auto"}};function ft(s,t,y,o,e,r){const h=g("v-select"),l=g("v-btn"),i=g("v-text-field"),u=g("font-awesome-icon"),k=g("v-progress-circular"),f=g("LineChartGenerator");return _(),T("div",Z,[d("div",$,[d("div",tt,[d("div",et,[c(h,{variant:"outlined",density:"compact",label:"요금제",items:e.useTypeList,modelValue:e.useType,"onUpdate:modelValue":t[0]||(t[0]=n=>e.useType=n)},null,8,["items","modelValue"])])]),d("div",st,[d("div",at,[d("div",it,[c(l,{variant:"outlined",class:S("white-button "+e.dateClass.day),onClick:t[1]||(t[1]=n=>r.setDateType("day"))},{default:L(()=>[V(" 일간 ")]),_:1},8,["class"]),c(l,{variant:"outlined",class:S("white-button "+e.dateClass.month),onClick:t[2]||(t[2]=n=>r.setDateType("month"))},{default:L(()=>[V("월간 ")]),_:1},8,["class"]),c(l,{variant:"outlined",class:S("white-button "+e.dateClass.year),onClick:t[3]||(t[3]=n=>r.setDateType("year"))},{default:L(()=>[V(" 연간 ")]),_:1},8,["class"])]),e.dateClass.day=="active"||e.dateClass.week=="active"?(_(),T("div",nt,[d("div",lt,[c(i,{modelValue:e.stdate,"onUpdate:modelValue":t[4]||(t[4]=n=>e.stdate=n),class:"day-item",variant:"outlined",density:"compact",type:"date"},null,8,["modelValue"])]),ot,d("div",rt,[c(i,{modelValue:e.endate,"onUpdate:modelValue":t[5]||(t[5]=n=>e.endate=n),class:"day-item",variant:"outlined",type:"date",density:"compact"},null,8,["modelValue"])])])):e.dateClass.month=="active"?(_(),T("div",dt,[d("div",null,[c(i,{modelValue:e.stmonth,"onUpdate:modelValue":t[6]||(t[6]=n=>e.stmonth=n),variant:"outlined",density:"compact",style:{"max-width":"130px",width:"130px"},suffix:"월"},null,8,["modelValue"])]),ht,d("div",null,[c(i,{modelValue:e.enmonth,"onUpdate:modelValue":t[7]||(t[7]=n=>e.enmonth=n),variant:"outlined",density:"compact",style:{"max-width":"130px",width:"130px"},suffix:"월"},null,8,["modelValue"])])])):(_(),T("div",pt,[c(h,{class:"year-item",modelValue:e.styear,"onUpdate:modelValue":t[8]||(t[8]=n=>e.styear=n),variant:"outlined",density:"compact",items:e.yearList},null,8,["modelValue","items"]),mt,c(h,{class:"year-item",variant:"outlined",density:"compact",modelValue:e.enyear,"onUpdate:modelValue":t[9]||(t[9]=n=>e.enyear=n),items:e.yearList},null,8,["modelValue","items"])])),d("div",ct,[c(l,{depressed:"",class:"white-button submit-button",onClick:t[10]||(t[10]=n=>r.search())},{default:L(()=>[c(u,{icon:"fa-solid fa-magnifying-glass",style:{"margin-right":"6px"}}),V(" 검색 ")]),_:1})])])]),d("div",yt,[e.chartShow?N("",!0):(_(),Y(k,{key:0,size:100,class:"progress-box",color:"#DD1B16",indeterminate:""})),d("div",ut,[e.chartShow?(_(),Y(f,{key:0,options:e.chartOptions,data:e.chartData,height:"500"},null,8,["options","data"])):N("",!0)])])])])}const Lt=J(X,[["render",ft],["__scopeId","data-v-a4b55a9e"]]);export{Lt as default};
